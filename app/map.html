<!DOCTYPE html>
<html>

//= tpl/head.html
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
<script src="https://yandex.st/jquery/2.2.3/jquery.min.js" type="text/javascript"></script>

<body>

    <div id="map"></div>

<script>
    ymaps.ready(init);

    function init() {

        // Создание экземпляра карты.
        var myMap = new ymaps.Map('map', {
                center: [47.230731, 39.724589],
                zoom: 14
            }, {
                searchControlProvider: 'yandex#search'
            }),
            // Контейнер для меню.
            menu = $('<ul class="menu"/>');

        for (var i = 0, l = groups.length; i < l; i++) {
            createMenuGroup(groups[i]);
        }

        function createMenuGroup (group) {
            // Пункт меню.
            var menuItem = $('<li><a href="#">' + group.name + '</a></li>'),
                // Коллекция для геообъектов группы.
                collection = new ymaps.GeoObjectCollection(null, { preset: group.style }),
                // Контейнер для подменю.
                submenu = $('<ul class="submenu"/>');

            // Добавляем коллекцию на карту.
            myMap.geoObjects.add(collection);
            // Добавляем подменю.
            menuItem
                .append(submenu)
                // Добавляем пункт в меню.
                .appendTo(menu)
                // По клику удаляем/добавляем коллекцию на карту и скрываем/отображаем подменю.
                .find('a')
                .bind('click', function () {
                    if (collection.getParent()) {
                        myMap.geoObjects.remove(collection);
                        submenu.hide();
                    } else {
                        myMap.geoObjects.add(collection);
                        submenu.show();
                    }
                });
            for (var j = 0, m = group.items.length; j < m; j++) {
                createSubMenu(group.items[j], collection, submenu);
            }
        }

        function createSubMenu (item, collection, submenu) {
            // Пункт подменю.
            var submenuItem = $('<li><a href="#">' + item.name + '</a></li>'),
                // Создаем метку.
                placemark = new ymaps.Placemark(item.center, { balloonContent: item.name });

            // Добавляем метку в коллекцию.
            collection.add(placemark);
            // Добавляем пункт в подменю.
            submenuItem
                .appendTo(submenu)
                // При клике по пункту подменю открываем/закрываем баллун у метки.
                .find('a')
                .bind('click', function () {
                    if (!placemark.balloon.isOpen()) {
                        placemark.balloon.open();
                    } else {
                        placemark.balloon.close();
                    }
                    return false;
                });
        }

        // Добавляем меню в тэг BODY.
        menu.appendTo($('body'));
        // Выставляем масштаб карты чтобы были видны все группы.
        myMap.setBounds(myMap.geoObjects.getBounds());
    }

    // Группы объектов
    var groups = [
        {
            name: "Студия кухни nobilia",
            style: "islands#redIcon",
            items: [
                {
                    center: [47.230731, 39.724589],
                    name: "<p class='title'>График работы:</p>" +
                    "<p class='text'>пн-сб: с 10:00 до 19:00,<br>" +
                    "вс: с 10:00 до 17:00</p>" +
                    "<p class='title'>Адрес:</p>" +
                    "<p class='text'>г.Ростов-на-Дону,<br>" +
                    "ул.Красноармейска д.103/123" +
                    "<p>Телефон:  +7 (863) 299-44-53</p>"
                }
            ]}
    ];
</script>
</body>
</html>