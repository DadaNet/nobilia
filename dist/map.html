<!DOCTYPE html>
<html>

<head>
	<!-- META -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<html lang="en">


	<!-- FAVICON -->
	<link rel="icon" type="image/x-icon" href="favicon.ico" >
	<link rel="icon" type="image/png" href="favicon.png" type="image/x-icon">


	<!-- SEO -->
	<meta name="description" content="">
	<meta name="rating" content="">
	<meta name="author" content="">
	<meta name="robots" content="index,follow">

	<!-- CONFIG -->
	<meta name="format-detection" content="telephone=no">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">


	<!-- Tweeter card -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@site_account">
	<meta name="twitter:creator" content="@individual_account">
	<meta name="twitter:url" content="https://example.com/page.html">
	<meta name="twitter:title" content="Content Title">
	<meta name="twitter:description" content="Content description less than 200 characters">
	<meta name="twitter:image" content="https://example.com/image.jpg">


	<!-- Facebook card -->
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://example.com/page.html">
	<meta property="og:title" content="Content Title">
	<meta property="og:image" content="https://example.com/image.jpg">
	<meta property="og:description" content="Description Here">
	<meta property="og:site_name" content="Site Name">
	<meta property="og:locale" content="en_US">

	<!-- CSS -->
	<link rel="stylesheet" href="css/main.css">

	<title>Шаблон проекта от Code.mba</title>


	<!--JAVASCRIPT-->
	<script src="https://yandex.st/jquery/2.2.3/jquery.min.js" type="text/javascript"></script>
	<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>

</head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<body>

    <div id="map"></div>

    <script src="https://yandex.st/jquery/2.2.3/jquery.min.js" type="text/javascript"></script>
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
    <script>
        // Группы объектов
        var groups = [
            {
                name: "Студия кухни nobilia",
                style: "islands#redIcon",
                items: [
                    {
                        center: [47.230731, 39.724589],
                        name: "<p class='title'>График работы:</p>" +
                        "<p class='text'>пн-сб: с 10:00 до 19:00,<br>" +
                        "вс: с 10:00 до 17:00</p>" +
                        "<p class='title'>Адрес:</p>" +
                        "<p class='text'>г.Ростов-на-Дону,<br>" +
                        "ул.Красноармейска д.103/123" +
                        "<p>Телефон:  +7 (863) 299-44-53</p>"
                    }
                ]}
        ];

        ymaps.ready(init);

        function init() {

            // Создание экземпляра карты.
            var myMap = new ymaps.Map('map', {
                    center: [47.230731, 39.724589],
                    zoom: 13,
                    controls: ['zoomControl', 'fullscreenControl', 'geolocationControl']
                }, {
                    searchControlProvider: 'yandex#search'
                }),
                // Контейнер для меню.
                menu = $('<ul class="menu"/>');

            for (var i = 0, l = groups.length; i < l; i++) {
                createMenuGroup(groups[i]);
            }

            function createMenuGroup (group) {
                // Пункт меню.
                var menuItem = $('<li><a href="#">' + group.name + '</a></li>'),
                    // Коллекция для геообъектов группы.
                    collection = new ymaps.GeoObjectCollection(null, { preset: group.style }),
                    // Контейнер для подменю.
                    submenu = $('<ul class="submenu"/>');

                // Добавляем коллекцию на карту.
                myMap.geoObjects.add(collection);
                // Добавляем подменю.
                menuItem
                    .append(submenu)
                    // Добавляем пункт в меню.
                    .appendTo(menu)
                    // По клику удаляем/добавляем коллекцию на карту и скрываем/отображаем подменю.
                    .find('a')
                    .bind('click', function () {
                        if (collection.getParent()) {
                            myMap.geoObjects.remove(collection);
                            submenu.hide();
                        } else {
                            myMap.geoObjects.add(collection);
                            submenu.show();
                        }
                    });
                for (var j = 0, m = group.items.length; j < m; j++) {
                    createSubMenu(group.items[j], collection, submenu);
                }
            }

            function createSubMenu (item, collection, submenu) {
                // Пункт подменю.
                var submenuItem = $('<li><a href="#">' + item.name + '</a></li>'),
                    // Создаем метку.
                    placemark = new ymaps.Placemark(item.center, { balloonContent: item.name });

                // Добавляем метку в коллекцию.
                collection.add(placemark);
                // Добавляем пункт в подменю.
                submenuItem
                    .appendTo(submenu)
                    // При клике по пункту подменю открываем/закрываем баллун у метки.
                    .find('a')
                    .bind('click', function () {
                        if (!placemark.balloon.isOpen()) {
                            placemark.balloon.open();
                        } else {
                            placemark.balloon.close();
                        }
                        return false;
                    });
            }

            // Добавляем меню в тэг BODY.
            menu.appendTo($('body'));
            myMap.setBounds({
                checkZoomRange: true,
            });
            // Выставляем масштаб карты чтобы были видны все группы.
            myMap.setBounds(myMap.geoObjects.getBounds());
        }

    </script>
</body>
</html>